{
  "paragraphs": [
    {
      "text": "%sh\npip install kafka-python\necho $PWD\nmkdir dep\ncd ./dep \u0026\u0026 wget https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:52:55.367",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sh",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Collecting kafka-python\n  Downloading https://files.pythonhosted.org/packages/aa/34/12f219f7f9e68e79a54874d26fbe974db1ab4efac4e6dae665b421df48f9/kafka_python-2.0.1-py2.py3-none-any.whl (232kB)\nInstalling collected packages: kafka-python\nSuccessfully installed kafka-python-2.0.1\nYou are using pip version 8.1.2, however version 20.1.1 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\n/zeppelin\n--2020-06-30 18:53:02--  https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\nResolving repo1.maven.org (repo1.maven.org)... 151.101.132.209\nConnecting to repo1.maven.org (repo1.maven.org)|151.101.132.209|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 11292862 (11M) [application/java-archive]\nSaving to: ‘spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar’\n\n     0K .......... .......... .......... .......... ..........  0% 6.14M 2s\n    50K .......... .......... .......... .......... ..........  0% 1.86M 4s\n   100K .......... .......... .......... .......... ..........  1% 31.8M 3s\n   150K .......... .......... .......... .......... ..........  1% 2.23M 3s\n   200K .......... .......... .......... .......... ..........  2% 2.14M 3s\n   250K .......... .......... .......... .......... ..........  2%  434K 7s\n   300K .......... .......... .......... .......... ..........  3% 1.72M 7s\n   350K .......... .......... .......... .......... ..........  3% 26.5M 6s\n   400K .......... .......... .......... .......... ..........  4% 25.9M 5s\n   450K .......... .......... .......... .......... ..........  4%  840K 6s\n   500K .......... .......... .......... .......... ..........  4% 24.4M 6s\n   550K .......... .......... .......... .......... ..........  5% 42.3M 5s\n   600K .......... .......... .......... .......... ..........  5%  596K 6s\n   650K .......... .......... .......... .......... ..........  6% 20.7M 6s\n   700K .......... .......... .......... .......... ..........  6% 33.0M 5s\n   750K .......... .......... .......... .......... ..........  7% 1.06M 5s\n   800K .......... .......... .......... .......... ..........  7% 25.4M 5s\n   850K .......... .......... .......... .......... ..........  8% 10.8M 5s\n   900K .......... .......... .......... .......... ..........  8% 37.8M 5s\n   950K .......... .......... .......... .......... ..........  9% 13.3M 4s\n  1000K .......... .......... .......... .......... ..........  9% 29.3M 4s\n  1050K .......... .......... .......... .......... ..........  9% 12.7M 4s\n  1100K .......... .......... .......... .......... .......... 10% 1.74M 4s\n  1150K .......... .......... .......... .......... .......... 10% 33.4M 4s\n  1200K .......... .......... .......... .......... .......... 11%  947K 4s\n  1250K .......... .......... .......... .......... .......... 11% 18.3M 4s\n  1300K .......... .......... .......... .......... .......... 12% 35.9M 4s\n  1350K .......... .......... .......... .......... .......... 12% 12.0M 4s\n  1400K .......... .......... .......... .......... .......... 13% 12.3M 4s\n  1450K .......... .......... .......... .......... .......... 13% 1.26M 4s\n  1500K .......... .......... .......... .......... .......... 14% 35.2M 4s\n  1550K .......... .......... .......... .......... .......... 14% 5.48M 3s\n  1600K .......... .......... .......... .......... .......... 14% 3.06M 3s\n  1650K .......... .......... .......... .......... .......... 15% 2.08M 3s\n  1700K .......... .......... .......... .......... .......... 15% 30.6M 3s\n  1750K .......... .......... .......... .......... .......... 16% 28.8M 3s\n  1800K .......... .......... .......... .......... .......... 16% 3.31M 3s\n  1850K .......... .......... .......... .......... .......... 17% 33.3M 3s\n  1900K .......... .......... .......... .......... .......... 17% 17.1M 3s\n  1950K .......... .......... .......... .......... .......... 18% 2.42M 3s\n  2000K .......... .......... .......... .......... .......... 18% 26.9M 3s\n  2050K .......... .......... .......... .......... .......... 19% 2.56M 3s\n  2100K .......... .......... .......... .......... .......... 19% 1.07M 3s\n  2150K .......... .......... .......... .......... .......... 19% 14.3M 3s\n  2200K .......... .......... .......... .......... .......... 20% 7.25M 3s\n  2250K .......... .......... .......... .......... .......... 20% 29.8M 3s\n  2300K .......... .......... .......... .......... .......... 21% 2.88M 3s\n  2350K .......... .......... .......... .......... .......... 21% 12.6M 3s\n  2400K .......... .......... .......... .......... .......... 22% 1.35M 3s\n  2450K .......... .......... .......... .......... .......... 22% 2.15M 3s\n  2500K .......... .......... .......... .......... .......... 23% 2.49M 3s\n  2550K .......... .......... .......... .......... .......... 23% 5.90M 3s\n  2600K .......... .......... .......... .......... .......... 24% 20.7M 3s\n  2650K .......... .......... .......... .......... .......... 24% 1.46M 3s\n  2700K .......... .......... .......... .......... .......... 24% 1.98M 3s\n  2750K .......... .......... .......... .......... .......... 25% 2.82M 3s\n  2800K .......... .......... .......... .......... .......... 25%  735K 3s\n  2850K .......... .......... .......... .......... .......... 26% 4.19M 3s\n  2900K .......... .......... .......... .......... .......... 26% 11.4M 3s\n  2950K .......... .......... .......... .......... .......... 27% 2.33M 3s\n  3000K .......... .......... .......... .......... .......... 27% 25.5M 3s\n  3050K .......... .......... .......... .......... .......... 28% 37.0M 3s\n  3100K .......... .......... .......... .......... .......... 28% 2.52M 3s\n  3150K .......... .......... .......... .......... .......... 29% 2.83M 3s\n  3200K .......... .......... .......... .......... .......... 29% 1.01M 3s\n  3250K .......... .......... .......... .......... .......... 29% 29.0M 3s\n  3300K .......... .......... .......... .......... .......... 30% 2.66M 3s\n  3350K .......... .......... .......... .......... .......... 30% 28.9M 3s\n  3400K .......... .......... .......... .......... .......... 31% 10.2M 3s\n  3450K .......... .......... .......... .......... .......... 31% 1.51M 3s\n  3500K .......... .......... .......... .......... .......... 32% 1.55M 3s\n  3550K .......... .......... .......... .......... .......... 32% 1.41M 3s\n  3600K .......... .......... .......... .......... .......... 33% 6.74M 3s\n  3650K .......... .......... .......... .......... .......... 33% 2.54M 3s\n  3700K .......... .......... .......... .......... .......... 34% 35.9M 2s\n  3750K .......... .......... .......... .......... .......... 34% 3.07M 2s\n  3800K .......... .......... .......... .......... .......... 34% 1.25M 2s\n  3850K .......... .......... .......... .......... .......... 35% 28.0M 2s\n  3900K .......... .......... .......... .......... .......... 35% 7.11M 2s\n  3950K .......... .......... .......... .......... .......... 36% 10.6M 2s\n  4000K .......... .......... .......... .......... .......... 36% 3.55M 2s\n  4050K .......... .......... .......... .......... .......... 37% 5.46M 2s\n  4100K .......... .......... .......... .......... .......... 37% 2.94M 2s\n  4150K .......... .......... .......... .......... .......... 38% 1.66M 2s\n  4200K .......... .......... .......... .......... .......... 38% 2.62M 2s\n  4250K .......... .......... .......... .......... .......... 38% 18.3M 2s\n  4300K .......... .......... .......... .......... .......... 39% 3.04M 2s\n  4350K .......... .......... .......... .......... .......... 39% 2.08M 2s\n  4400K .......... .......... .......... .......... .......... 40% 27.6M 2s\n  4450K .......... .......... .......... .......... .......... 40% 4.36M 2s\n  4500K .......... .......... .......... .......... .......... 41% 1.80M 2s\n  4550K .......... .......... .......... .......... .......... 41% 2.56M 2s\n  4600K .......... .......... .......... .......... .......... 42% 23.9M 2s\n  4650K .......... .......... .......... .......... .......... 42% 25.8M 2s\n  4700K .......... .......... .......... .......... .......... 43% 1.80M 2s\n  4750K .......... .......... .......... .......... .......... 43% 14.7M 2s\n  4800K .......... .......... .......... .......... .......... 43% 1.90M 2s\n  4850K .......... .......... .......... .......... .......... 44% 26.6M 2s\n  4900K .......... .......... .......... .......... .......... 44% 39.4M 2s\n  4950K .......... .......... .......... .......... .......... 45% 3.14M 2s\n  5000K .......... .......... .......... .......... .......... 45% 25.2M 2s\n  5050K .......... .......... .......... .......... .......... 46% 19.1M 2s\n  5100K .......... .......... .......... .......... .......... 46% 1.91M 2s\n  5150K .......... .......... .......... .......... .......... 47% 2.49M 2s\n  5200K .......... .......... .......... .......... .......... 47% 32.8M 2s\n  5250K .......... .......... .......... .......... .......... 48% 38.0M 2s\n  5300K .......... .......... .......... .......... .......... 48% 3.47M 2s\n  5350K .......... .......... .......... .......... .......... 48% 37.7M 2s\n  5400K .......... .......... .......... .......... .......... 49% 14.7M 2s\n  5450K .......... .......... .......... .......... .......... 49% 2.41M 2s\n  5500K .......... .......... .......... .......... .......... 50% 28.7M 2s\n  5550K .......... .......... .......... .......... .......... 50% 2.63M 2s\n  5600K .......... .......... .......... .......... .......... 51% 21.9M 2s\n  5650K .......... .......... .......... .......... .......... 51% 29.1M 2s\n  5700K .......... .......... .......... .......... .......... 52% 3.97M 2s\n  5750K .......... .......... .......... .......... .......... 52% 1.57M 2s\n  5800K .......... .......... .......... .......... .......... 53% 34.6M 2s\n  5850K .......... .......... .......... .......... .......... 53% 2.36M 2s\n  5900K .......... .......... .......... .......... .......... 53% 4.75M 2s\n  5950K .......... .......... .......... .......... .......... 54% 33.7M 2s\n  6000K .......... .......... .......... .......... .......... 54%  711K 2s\n  6050K .......... .......... .......... .......... .......... 55% 20.1M 2s\n  6100K .......... .......... .......... .......... .......... 55% 43.7M 1s\n  6150K .......... .......... .......... .......... .......... 56% 4.24M 1s\n  6200K .......... .......... .......... .......... .......... 56% 11.1M 1s\n  6250K .......... .......... .......... .......... .......... 57% 1.21M 1s\n  6300K .......... .......... .......... .......... .......... 57% 36.6M 1s\n  6350K .......... .......... .......... .......... .......... 58% 27.0M 1s\n  6400K .......... .......... .......... .......... .......... 58%  935K 1s\n  6450K .......... .......... .......... .......... .......... 58% 31.9M 1s\n  6500K .......... .......... .......... .......... .......... 59% 38.4M 1s\n  6550K .......... .......... .......... .......... .......... 59% 3.47M 1s\n  6600K .......... .......... .......... .......... .......... 60% 12.2M 1s\n  6650K .......... .......... .......... .......... .......... 60% 1.24M 1s\n  6700K .......... .......... .......... .......... .......... 61%  953K 1s\n  6750K .......... .......... .......... .......... .......... 61% 32.8M 1s\n  6800K .......... .......... .......... .......... .......... 62% 3.16M 1s\n  6850K .......... .......... .......... .......... .......... 62% 19.4M 1s\n  6900K .......... .......... .......... .......... .......... 63% 2.35M 1s\n  6950K .......... .......... .......... .......... .......... 63% 30.5M 1s\n  7000K .......... .......... .......... .......... .......... 63% 3.08M 1s\n  7050K .......... .......... .......... .......... .......... 64% 38.9M 1s\n  7100K .......... .......... .......... .......... .......... 64% 28.2M 1s\n  7150K .......... .......... .......... .......... .......... 65% 3.86M 1s\n  7200K .......... .......... .......... .......... .......... 65% 30.5M 1s\n  7250K .......... .......... .......... .......... .......... 66% 7.07M 1s\n  7300K .......... .......... .......... .......... .......... 66% 4.86M 1s\n  7350K .......... .......... .......... .......... .......... 67% 3.12M 1s\n  7400K .......... .......... .......... .......... .......... 67% 32.5M 1s\n  7450K .......... .......... .......... .......... .......... 68% 21.5M 1s\n  7500K .......... .......... .......... .......... .......... 68%  636K 1s\n  7550K .......... .......... .......... .......... .......... 68% 31.8M 1s\n  7600K .......... .......... .......... .......... .......... 69% 35.4M 1s\n  7650K .......... .......... .......... .......... .......... 69% 46.4M 1s\n  7700K .......... .......... .......... .......... .......... 70% 39.5M 1s\n  7750K .......... .......... .......... .......... .......... 70% 1.56M 1s\n  7800K .......... .......... .......... .......... .......... 71% 15.7M 1s\n  7850K .......... .......... .......... .......... .......... 71% 4.47M 1s\n  7900K .......... .......... .......... .......... .......... 72% 29.2M 1s\n  7950K .......... .......... .......... .......... .......... 72% 18.8M 1s\n  8000K .......... .......... .......... .......... .......... 72% 7.51M 1s\n  8050K .......... .......... .......... .......... .......... 73% 1.67M 1s\n  8100K .......... .......... .......... .......... .......... 73% 2.58M 1s\n  8150K .......... .......... .......... .......... .......... 74% 31.4M 1s\n  8200K .......... .......... .......... .......... .......... 74% 4.11M 1s\n  8250K .......... .......... .......... .......... .......... 75% 22.2M 1s\n  8300K .......... .......... .......... .......... .......... 75% 12.1M 1s\n  8350K .......... .......... .......... .......... .......... 76% 32.2M 1s\n  8400K .......... .......... .......... .......... .......... 76% 11.6M 1s\n  8450K .......... .......... .......... .......... .......... 77% 1.06M 1s\n  8500K .......... .......... .......... .......... .......... 77% 13.0M 1s\n  8550K .......... .......... .......... .......... .......... 77% 8.98M 1s\n  8600K .......... .......... .......... .......... .......... 78% 2.51M 1s\n  8650K .......... .......... .......... .......... .......... 78% 33.4M 1s\n  8700K .......... .......... .......... .......... .......... 79% 23.2M 1s\n  8750K .......... .......... .......... .......... .......... 79% 1.92M 1s\n  8800K .......... .......... .......... .......... .......... 80% 12.1M 1s\n  8850K .......... .......... .......... .......... .......... 80% 1.76M 1s\n  8900K .......... .......... .......... .......... .......... 81% 5.07M 1s\n  8950K .......... .......... .......... .......... .......... 81% 30.4M 1s\n  9000K .......... .......... .......... .......... .......... 82% 3.45M 1s\n  9050K .......... .......... .......... .......... .......... 82% 13.4M 1s\n  9100K .......... .......... .......... .......... .......... 82% 34.3M 1s\n  9150K .......... .......... .......... .......... .......... 83% 2.67M 1s\n  9200K .......... .......... .......... .......... .......... 83% 2.53M 1s\n  9250K .......... .......... .......... .......... .......... 84% 5.29M 0s\n  9300K .......... .......... .......... .......... .......... 84% 12.3M 0s\n  9350K .......... .......... .......... .......... .......... 85% 2.96M 0s\n  9400K .......... .......... .......... .......... .......... 85% 5.05M 0s\n  9450K .......... .......... .......... .......... .......... 86% 2.57M 0s\n  9500K .......... .......... .......... .......... .......... 86% 5.19M 0s\n  9550K .......... .......... .......... .......... .......... 87% 27.8M 0s\n  9600K .......... .......... .......... .......... .......... 87% 37.6M 0s\n  9650K .......... .......... .......... .......... .......... 87% 29.5M 0s\n  9700K .......... .......... .......... .......... .......... 88% 37.2M 0s\n  9750K .......... .......... .......... .......... .......... 88% 1.31M 0s\n  9800K .......... .......... .......... .......... .......... 89% 16.2M 0s\n  9850K .......... .......... .......... .......... .......... 89% 4.48M 0s\n  9900K .......... .......... .......... .......... .......... 90% 30.1M 0s\n  9950K .......... .......... .......... .......... .......... 90% 13.0M 0s\n 10000K .......... .......... .......... .......... .......... 91% 14.6M 0s\n 10050K .......... .......... .......... .......... .......... 91% 1.26M 0s\n 10100K .......... .......... .......... .......... .......... 92% 33.0M 0s\n 10150K .......... .......... .......... .......... .......... 92% 40.3M 0s\n 10200K .......... .......... .......... .......... .......... 92% 1.86M 0s\n 10250K .......... .......... .......... .......... .......... 93% 36.2M 0s\n 10300K .......... .......... .......... .......... .......... 93% 4.32M 0s\n 10350K .......... .......... .......... .......... .......... 94% 9.30M 0s\n 10400K .......... .......... .......... .......... .......... 94% 1.18M 0s\n 10450K .......... .......... .......... .......... .......... 95% 16.1M 0s\n 10500K .......... .......... .......... .......... .......... 95% 19.7M 0s\n 10550K .......... .......... .......... .......... .......... 96% 22.5M 0s\n 10600K .......... .......... .......... .......... .......... 96% 4.41M 0s\n 10650K .......... .......... .......... .......... .......... 97% 6.70M 0s\n 10700K .......... .......... .......... .......... .......... 97% 2.74M 0s\n 10750K .......... .......... .......... .......... .......... 97% 3.72M 0s\n 10800K .......... .......... .......... .......... .......... 98% 44.9M 0s\n 10850K .......... .......... .......... .......... .......... 98% 61.9M 0s\n 10900K .......... .......... .......... .......... .......... 99% 7.52M 0s\n 10950K .......... .......... .......... .......... .......... 99% 1.22M 0s\n 11000K .......... .......... ........                        100% 17.9M\u003d3.0s\n\n2020-06-30 18:53:05 (3.59 MB/s) - ‘spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar’ saved [11292862/11292862]\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593541419040_-578626173",
      "id": "20190429-115420_1698791579",
      "dateCreated": "2020-06-30 18:23:39.040",
      "dateStarted": "2020-06-30 18:52:55.830",
      "dateFinished": "2020-06-30 18:53:06.206",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.dep\nz.reset()\nz.load(\"/zeppelin/dep/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\")",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:53:18.930",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res0: org.apache.zeppelin.dep.Dependency \u003d org.apache.zeppelin.dep.Dependency@119f48dc\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593541419040_-208542783",
      "id": "20200630-074700_496348867",
      "dateCreated": "2020-06-30 18:23:39.040",
      "dateStarted": "2020-06-30 18:53:19.097",
      "dateFinished": "2020-06-30 18:53:56.662",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\nls /datadrive",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:29:04.319",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/sh",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "census_1000.csv\noccupancy_data.csv\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593541591463_664344803",
      "id": "20200630-182631_240634991",
      "dateCreated": "2020-06-30 18:26:31.463",
      "dateStarted": "2020-06-30 18:29:04.753",
      "dateFinished": "2020-06-30 18:29:05.204",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "",
      "text": "%producer.pyspark\n\ndf \u003d (spark.read.format(\"com.databricks.spark.csv\")\n        .option(\"header\", \"true\")\n        .option(\"inferSchema\",\"true\")\n        .load(\"/datadrive/occupancy_data.csv\"))\n        \ndf_list \u003d df.collect()\ndf.show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:54:02.349",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+-------------------+--------+----------------+-----+----------------+-------------------+\n|date|        Temperature|Humidity|           Light|  CO2|   HumidityRatio|          Occupancy|\n+----+-------------------+--------+----------------+-----+----------------+-------------------+\n|   1|2015-02-04 17:51:00|   23.18|          27.272|426.0|          721.25|0.00479298817650529|\n|   2|2015-02-04 17:51:59|   23.15|         27.2675|429.5|           714.0|0.00478344094931065|\n|   3|2015-02-04 17:53:00|   23.15|          27.245|426.0|           713.5|0.00477946352442199|\n|   4|2015-02-04 17:54:00|   23.15|            27.2|426.0|          708.25|0.00477150882608175|\n|   5|2015-02-04 17:55:00|    23.1|            27.2|426.0|           704.5|0.00475699293331518|\n|   6|2015-02-04 17:55:59|    23.1|            27.2|419.0|           701.0|0.00475699293331518|\n|   7|2015-02-04 17:57:00|    23.1|            27.2|419.0|701.666666666667|0.00475699293331518|\n|   8|2015-02-04 17:57:59|    23.1|            27.2|419.0|           699.0|0.00475699293331518|\n|   9|2015-02-04 17:58:59|    23.1|            27.2|419.0|689.333333333333|0.00475699293331518|\n|  10|2015-02-04 18:00:00|  23.075|          27.175|419.0|           688.0|0.00474535071966655|\n|  11|2015-02-04 18:01:00|  23.075|           27.15|419.0|          690.25|0.00474095189694268|\n|  12|2015-02-04 18:02:00|    23.1|            27.1|419.0|           691.0|0.00473937073052061|\n|  13|2015-02-04 18:03:00|    23.1|27.1666666666667|419.0|           683.5|0.00475111875560951|\n|  14|2015-02-04 18:04:00|   23.05|           27.15|419.0|           687.5| 0.0047337317970825|\n|  15|2015-02-04 18:04:59|    23.0|          27.125|419.0|           686.0|0.00471494214590473|\n|  16|2015-02-04 18:06:00|    23.0|          27.125|418.5|           680.5|0.00471494214590473|\n|  17|2015-02-04 18:07:00|    23.0|            27.2|  0.0|           681.5|0.00472807794966877|\n|  18|2015-02-04 18:08:00|  22.945|           27.29|  0.0|           685.0|0.00472795137178073|\n|  19|2015-02-04 18:08:59|  22.945|           27.39|  0.0|           685.0| 0.0047454083970941|\n|  20|2015-02-04 18:10:00|   22.89|           27.39|  0.0|           689.0|0.00472950615591001|\n+----+-------------------+--------+----------------+-----+----------------+-------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://172.25.0.19:4040/jobs/job?id\u003d0",
            "http://172.25.0.19:4040/jobs/job?id\u003d1",
            "http://172.25.0.19:4040/jobs/job?id\u003d2",
            "http://172.25.0.19:4040/jobs/job?id\u003d3"
          ],
          "interpreterSettingId": "producer"
        }
      },
      "apps": [],
      "jobName": "paragraph_1593541419041_42446930",
      "id": "20190424-153802_2004623441",
      "dateCreated": "2020-06-30 18:23:39.041",
      "dateStarted": "2020-06-30 18:54:02.570",
      "dateFinished": "2020-06-30 18:56:35.981",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%producer.pyspark\nimport time\nimport json\nimport random\nimport logging\n\nfrom kafka import KafkaProducer\nfrom kafka.errors import KafkaError\n\nKAFKA_BROKER \u003d \"172.25.0.12:9092\"\nKAFKA_TOPIC \u003d \"default_topic\"\n\nproducer \u003d KafkaProducer(bootstrap_servers\u003d[KAFKA_BROKER])\nindex \u003d 0\n\nwhile True:\n    \n    row_dict \u003d df_list[index].asDict()\n    \n    future \u003d producer.send(\n        topic\u003dKAFKA_TOPIC, \n        key\u003dstr(row_dict[\"date\"]).encode(\"utf-8\"),\n        value\u003djson.dumps(row_dict).encode(\"utf-8\"))\n    \n    try:\n        record_metadata \u003d future.get(timeout\u003d10)\n    except KafkaError:\n        # Decide what to do if produce request failed...\n        logging.exception(\"Error\")\n        pass\n    \n    producer.flush()\n    \n    index +\u003d 1\n    time.sleep(random.uniform(0.6,1.3))",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 19:00:18.734",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[0;31m\u001b[0m\n\u001b[0;31mTypeError\u001b[0mTraceback (most recent call last)\n\u001b[0;32m\u003cipython-input-8-32f853d2db60\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m     20\u001b[0m         \u001b[0mtopic\u001b[0m\u001b[0;34m\u003d\u001b[0m\u001b[0mKAFKA_TOPIC\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     21\u001b[0m         \u001b[0mkey\u001b[0m\u001b[0;34m\u003d\u001b[0m\u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrow_dict\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"date\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"utf-8\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 22\u001b[0;31m         value\u003djson.dumps(row_dict).encode(\"utf-8\"))\n\u001b[0m\u001b[1;32m     23\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     24\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/opt/conda/lib/python2.7/json/__init__.pyc\u001b[0m in \u001b[0;36mdumps\u001b[0;34m(obj, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, encoding, default, sort_keys, **kw)\u001b[0m\n\u001b[1;32m    242\u001b[0m         \u001b[0mcls\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mNone\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mindent\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mNone\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mseparators\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mNone\u001b[0m \u001b[0;32mand\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    243\u001b[0m         encoding \u003d\u003d \u0027utf-8\u0027 and default is None and not sort_keys and not kw):\n\u001b[0;32m--\u003e 244\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0m_default_encoder\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    245\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mcls\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    246\u001b[0m         \u001b[0mcls\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mJSONEncoder\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/opt/conda/lib/python2.7/json/encoder.pyc\u001b[0m in \u001b[0;36mencode\u001b[0;34m(self, o)\u001b[0m\n\u001b[1;32m    205\u001b[0m         \u001b[0;31m# exceptions aren\u0027t as detailed.  The list call should be roughly\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    206\u001b[0m         \u001b[0;31m# equivalent to the PySequence_Fast that \u0027\u0027.join() would do.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 207\u001b[0;31m         \u001b[0mchunks\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miterencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mo\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0m_one_shot\u001b[0m\u001b[0;34m\u003d\u001b[0m\u001b[0mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    208\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchunks\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mlist\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtuple\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    209\u001b[0m             \u001b[0mchunks\u001b[0m \u001b[0;34m\u003d\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mchunks\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;32m/opt/conda/lib/python2.7/json/encoder.pyc\u001b[0m in \u001b[0;36miterencode\u001b[0;34m(self, o, _one_shot)\u001b[0m\n\u001b[1;32m    268\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkey_separator\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem_separator\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msort_keys\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    269\u001b[0m                 self.skipkeys, _one_shot)\n\u001b[0;32m--\u003e 270\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0m_iterencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mo\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    271\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    272\u001b[0m def _make_iterencode(markers, _default, _encoder, _indent, _floatstr,\n\n\u001b[0;32m/opt/conda/lib/python2.7/json/encoder.pyc\u001b[0m in \u001b[0;36mdefault\u001b[0;34m(self, o)\u001b[0m\n\u001b[1;32m    182\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    183\u001b[0m         \"\"\"\n\u001b[0;32m--\u003e 184\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mTypeError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrepr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mo\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;34m\" is not JSON serializable\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    185\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    186\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mo\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;31mTypeError\u001b[0m: datetime.datetime(2015, 2, 4, 17, 51) is not JSON serializable"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593541419041_-1798450150",
      "id": "20190424-165258_808657351",
      "dateCreated": "2020-06-30 18:23:39.041",
      "dateStarted": "2020-06-30 19:00:19.098",
      "dateFinished": "2020-06-30 19:00:20.410",
      "status": "ERROR",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.pyspark\n\nimport sys\nimport json\nfrom pyspark.streaming.kafka import KafkaUtils\nfrom pyspark.streaming import StreamingContext\n\n\n\nos.environ[\u0027PYSPARK_SUBMIT_ARGS\u0027] \u003d \u0027--jars spark-streaming-kafka-assembly_2.10-1.6.0.jar pyspark-shell\u0027\n\ntry:\n    # Reset streaming context if exists\n    ssc.stop(stopSparkContext\u003dFalse, stopGraceFully\u003dFalse)\nexcept:\n    pass\n\nssc \u003d StreamingContext(sc, batchDuration\u003d2)\n\nREDDIT_TOPIC \u003d \"default_topic\"\nKAFKA_BROKERS \u003d \"172.25.0.12:9092,172.25.0.13:9092\"\n\n#KAFKA_BROKER \u003d \"172.25.0.12:9092\"\n\nstream \u003d KafkaUtils.createDirectStream(\n                            ssc, \n                            [REDDIT_TOPIC], \n                            {\"metadata.broker.list\": KAFKA_BROKERS})\n\n#stream \u003d KafkaUtils.createDirectStream(\n#                            ssc, \n#                            [REDDIT_TOPIC], \n#                            {\"metadata.broker.list\": KAFKA_BROKER})\n\n\nstream \u003d stream.map(lambda x: json.loads(x[1]))\nstream \u003d stream.map(lambda x: (x[\"_c0\"], x[\"loan\"]))\n\nstream.pprint()\n\nssc.start()\nssc.awaitTermination()",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:23:39.041",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1593541419041_261119620",
      "id": "20190423-122009_873241770",
      "dateCreated": "2020-06-30 18:23:39.041",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:23:39.041",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1593541419041_645381348",
      "id": "20190429-143043_1027088896",
      "dateCreated": "2020-06-30 18:23:39.041",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "sistemasDistribuidos3",
  "id": "2FBAZHD76",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "producer:shared_process": [],
    "sh:shared_process": [],
    "consumer:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}