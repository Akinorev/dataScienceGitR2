{
  "paragraphs": [
    {
      "text": "%sh\npip install kafka-python\necho $PWD\nmkdir dep\ncd ./dep \u0026\u0026 wget https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\n\n#%sh\n#cd /zeppelin/dep \u0026\u0026 wget https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\n#%consumer.dep\n#z.reset()\n#z.load(\"/zeppelin/dep/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\")",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:16:39.501",
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sh",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Collecting kafka-python\n  Downloading https://files.pythonhosted.org/packages/aa/34/12f219f7f9e68e79a54874d26fbe974db1ab4efac4e6dae665b421df48f9/kafka_python-2.0.1-py2.py3-none-any.whl (232kB)\nInstalling collected packages: kafka-python\nSuccessfully installed kafka-python-2.0.1\nYou are using pip version 8.1.2, however version 20.1.1 is available.\nYou should consider upgrading via the \u0027pip install --upgrade pip\u0027 command.\n/zeppelin\n--2020-06-30 18:06:01--  https://repo1.maven.org/maven2/org/apache/spark/spark-streaming-kafka-0-8-assembly_2.11/2.0.2/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\nResolving repo1.maven.org (repo1.maven.org)... 151.101.132.209\nConnecting to repo1.maven.org (repo1.maven.org)|151.101.132.209|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 11292862 (11M) [application/java-archive]\nSaving to: ‘spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar’\n\n     0K .......... .......... .......... .......... ..........  0%  780K 14s\n    50K .......... .......... .......... .......... ..........  0% 1.42M 11s\n   100K .......... .......... .......... .......... ..........  1%  921K 11s\n   150K .......... .......... .......... .......... ..........  1%  914K 11s\n   200K .......... .......... .......... .......... ..........  2% 2.73M 10s\n   250K .......... .......... .......... .......... ..........  2% 8.20M 8s\n   300K .......... .......... .......... .......... ..........  3%  963K 9s\n   350K .......... .......... .......... .......... ..........  3% 25.8M 8s\n   400K .......... .......... .......... .......... ..........  4% 32.7M 7s\n   450K .......... .......... .......... .......... ..........  4% 8.92M 6s\n   500K .......... .......... .......... .......... ..........  4% 4.73M 6s\n   550K .......... .......... .......... .......... ..........  5% 3.14M 6s\n   600K .......... .......... .......... .......... ..........  5%  820K 6s\n   650K .......... .......... .......... .......... ..........  6% 5.13M 6s\n   700K .......... .......... .......... .......... ..........  6% 22.1M 5s\n   750K .......... .......... .......... .......... ..........  7% 33.5M 5s\n   800K .......... .......... .......... .......... ..........  7% 43.6M 5s\n   850K .......... .......... .......... .......... ..........  8% 39.2M 4s\n   900K .......... .......... .......... .......... ..........  8% 1.12M 5s\n   950K .......... .......... .......... .......... ..........  9% 28.5M 4s\n  1000K .......... .......... .......... .......... ..........  9% 16.0M 4s\n  1050K .......... .......... .......... .......... ..........  9% 11.5M 4s\n  1100K .......... .......... .......... .......... .......... 10% 2.76M 4s\n  1150K .......... .......... .......... .......... .......... 10% 1.16M 4s\n  1200K .......... .......... .......... .......... .......... 11% 28.1M 4s\n  1250K .......... .......... .......... .......... .......... 11% 37.1M 4s\n  1300K .......... .......... .......... .......... .......... 12% 40.5M 4s\n  1350K .......... .......... .......... .......... .......... 12% 31.0M 4s\n  1400K .......... .......... .......... .......... .......... 13% 14.9M 3s\n  1450K .......... .......... .......... .......... .......... 13% 51.1M 3s\n  1500K .......... .......... .......... .......... .......... 14% 7.04M 3s\n  1550K .......... .......... .......... .......... .......... 14% 1.66M 3s\n  1600K .......... .......... .......... .......... .......... 14% 4.02M 3s\n  1650K .......... .......... .......... .......... .......... 15% 13.4M 3s\n  1700K .......... .......... .......... .......... .......... 15% 3.30M 3s\n  1750K .......... .......... .......... .......... .......... 16% 23.3M 3s\n  1800K .......... .......... .......... .......... .......... 16% 1.71M 3s\n  1850K .......... .......... .......... .......... .......... 17% 2.88M 3s\n  1900K .......... .......... .......... .......... .......... 17% 26.2M 3s\n  1950K .......... .......... .......... .......... .......... 18% 16.6M 3s\n  2000K .......... .......... .......... .......... .......... 18% 1.68M 3s\n  2050K .......... .......... .......... .......... .......... 19% 3.34M 3s\n  2100K .......... .......... .......... .......... .......... 19% 17.9M 3s\n  2150K .......... .......... .......... .......... .......... 19% 6.71M 3s\n  2200K .......... .......... .......... .......... .......... 20% 20.5M 3s\n  2250K .......... .......... .......... .......... .......... 20% 1.05M 3s\n  2300K .......... .......... .......... .......... .......... 21% 4.95M 3s\n  2350K .......... .......... .......... .......... .......... 21% 17.3M 3s\n  2400K .......... .......... .......... .......... .......... 22% 2.92M 3s\n  2450K .......... .......... .......... .......... .......... 22% 1.64M 3s\n  2500K .......... .......... .......... .......... .......... 23% 30.8M 3s\n  2550K .......... .......... .......... .......... .......... 23% 21.1M 3s\n  2600K .......... .......... .......... .......... .......... 24% 2.36M 3s\n  2650K .......... .......... .......... .......... .......... 24% 1.87M 3s\n  2700K .......... .......... .......... .......... .......... 24% 4.82M 3s\n  2750K .......... .......... .......... .......... .......... 25% 1.67M 3s\n  2800K .......... .......... .......... .......... .......... 25%  946K 3s\n  2850K .......... .......... .......... .......... .......... 26% 34.5M 3s\n  2900K .......... .......... .......... .......... .......... 26% 1.99M 3s\n  2950K .......... .......... .......... .......... .......... 27% 2.81M 3s\n  3000K .......... .......... .......... .......... .......... 27% 24.7M 3s\n  3050K .......... .......... .......... .......... .......... 28% 28.8M 3s\n  3100K .......... .......... .......... .......... .......... 28% 2.45M 3s\n  3150K .......... .......... .......... .......... .......... 29% 4.55M 2s\n  3200K .......... .......... .......... .......... .......... 29% 20.3M 2s\n  3250K .......... .......... .......... .......... .......... 29% 2.95M 2s\n  3300K .......... .......... .......... .......... .......... 30%  981K 2s\n  3350K .......... .......... .......... .......... .......... 30% 28.9M 2s\n  3400K .......... .......... .......... .......... .......... 31% 1.29M 2s\n  3450K .......... .......... .......... .......... .......... 31% 33.6M 2s\n  3500K .......... .......... .......... .......... .......... 32% 20.9M 2s\n  3550K .......... .......... .......... .......... .......... 32% 36.3M 2s\n  3600K .......... .......... .......... .......... .......... 33% 13.1M 2s\n  3650K .......... .......... .......... .......... .......... 33% 2.33M 2s\n  3700K .......... .......... .......... .......... .......... 34% 34.6M 2s\n  3750K .......... .......... .......... .......... .......... 34% 6.95M 2s\n  3800K .......... .......... .......... .......... .......... 34% 24.5M 2s\n  3850K .......... .......... .......... .......... .......... 35% 1.80M 2s\n  3900K .......... .......... .......... .......... .......... 35% 26.6M 2s\n  3950K .......... .......... .......... .......... .......... 36% 1.29M 2s\n  4000K .......... .......... .......... .......... .......... 36% 1.94M 2s\n  4050K .......... .......... .......... .......... .......... 37% 2.26M 2s\n  4100K .......... .......... .......... .......... .......... 37% 12.6M 2s\n  4150K .......... .......... .......... .......... .......... 38% 6.31M 2s\n  4200K .......... .......... .......... .......... .......... 38% 17.0M 2s\n  4250K .......... .......... .......... .......... .......... 38% 2.33M 2s\n  4300K .......... .......... .......... .......... .......... 39% 30.2M 2s\n  4350K .......... .......... .......... .......... .......... 39% 12.3M 2s\n  4400K .......... .......... .......... .......... .......... 40% 11.7M 2s\n  4450K .......... .......... .......... .......... .......... 40% 4.41M 2s\n  4500K .......... .......... .......... .......... .......... 41% 7.61M 2s\n  4550K .......... .......... .......... .......... .......... 41% 1.77M 2s\n  4600K .......... .......... .......... .......... .......... 42% 1.05M 2s\n  4650K .......... .......... .......... .......... .......... 42% 6.91M 2s\n  4700K .......... .......... .......... .......... .......... 43% 7.64M 2s\n  4750K .......... .......... .......... .......... .......... 43% 7.60M 2s\n  4800K .......... .......... .......... .......... .......... 43% 1.47M 2s\n  4850K .......... .......... .......... .......... .......... 44% 32.3M 2s\n  4900K .......... .......... .......... .......... .......... 44% 34.8M 2s\n  4950K .......... .......... .......... .......... .......... 45% 32.4M 2s\n  5000K .......... .......... .......... .......... .......... 45% 3.60M 2s\n  5050K .......... .......... .......... .......... .......... 46% 13.9M 2s\n  5100K .......... .......... .......... .......... .......... 46% 1.41M 2s\n  5150K .......... .......... .......... .......... .......... 47% 31.0M 2s\n  5200K .......... .......... .......... .......... .......... 47% 32.4M 2s\n  5250K .......... .......... .......... .......... .......... 48% 14.4M 2s\n  5300K .......... .......... .......... .......... .......... 48% 1.12M 2s\n  5350K .......... .......... .......... .......... .......... 48% 13.2M 2s\n  5400K .......... .......... .......... .......... .......... 49% 18.0M 2s\n  5450K .......... .......... .......... .......... .......... 49% 33.0M 2s\n  5500K .......... .......... .......... .......... .......... 50% 25.6M 2s\n  5550K .......... .......... .......... .......... .......... 50% 3.29M 2s\n  5600K .......... .......... .......... .......... .......... 51% 8.40M 2s\n  5650K .......... .......... .......... .......... .......... 51% 4.29M 2s\n  5700K .......... .......... .......... .......... .......... 52% 1.06M 2s\n  5750K .......... .......... .......... .......... .......... 52% 19.2M 2s\n  5800K .......... .......... .......... .......... .......... 53% 33.1M 1s\n  5850K .......... .......... .......... .......... .......... 53% 32.4M 1s\n  5900K .......... .......... .......... .......... .......... 53% 27.9M 1s\n  5950K .......... .......... .......... .......... .......... 54% 37.6M 1s\n  6000K .......... .......... .......... .......... .......... 54% 1.46M 1s\n  6050K .......... .......... .......... .......... .......... 55% 3.45M 1s\n  6100K .......... .......... .......... .......... .......... 55% 1.57M 1s\n  6150K .......... .......... .......... .......... .......... 56% 61.8M 1s\n  6200K .......... .......... .......... .......... .......... 56% 66.4M 1s\n  6250K .......... .......... .......... .......... .......... 57% 3.47M 1s\n  6300K .......... .......... .......... .......... .......... 57%  947K 1s\n  6350K .......... .......... .......... .......... .......... 58% 3.11M 1s\n  6400K .......... .......... .......... .......... .......... 58% 29.8M 1s\n  6450K .......... .......... .......... .......... .......... 58% 1.86M 1s\n  6500K .......... .......... .......... .......... .......... 59% 30.2M 1s\n  6550K .......... .......... .......... .......... .......... 59% 6.29M 1s\n  6600K .......... .......... .......... .......... .......... 60% 7.84M 1s\n  6650K .......... .......... .......... .......... .......... 60% 4.21M 1s\n  6700K .......... .......... .......... .......... .......... 61% 3.22M 1s\n  6750K .......... .......... .......... .......... .......... 61% 3.36M 1s\n  6800K .......... .......... .......... .......... .......... 62%  914K 1s\n  6850K .......... .......... .......... .......... .......... 62% 2.96M 1s\n  6900K .......... .......... .......... .......... .......... 63% 3.30M 1s\n  6950K .......... .......... .......... .......... .......... 63% 29.8M 1s\n  7000K .......... .......... .......... .......... .......... 63% 9.76M 1s\n  7050K .......... .......... .......... .......... .......... 64% 1.39M 1s\n  7100K .......... .......... .......... .......... .......... 64% 1.92M 1s\n  7150K .......... .......... .......... .......... .......... 65% 2.13M 1s\n  7200K .......... .......... .......... .......... .......... 65% 1.65M 1s\n  7250K .......... .......... .......... .......... .......... 66% 2.87M 1s\n  7300K .......... .......... .......... .......... .......... 66% 3.72M 1s\n  7350K .......... .......... .......... .......... .......... 67% 15.8M 1s\n  7400K .......... .......... .......... .......... .......... 67% 2.90M 1s\n  7450K .......... .......... .......... .......... .......... 68%  837K 1s\n  7500K .......... .......... .......... .......... .......... 68% 3.72M 1s\n  7550K .......... .......... .......... .......... .......... 68% 1.29M 1s\n  7600K .......... .......... .......... .......... .......... 69% 28.5M 1s\n  7650K .......... .......... .......... .......... .......... 69% 8.33M 1s\n  7700K .......... .......... .......... .......... .......... 70% 28.4M 1s\n  7750K .......... .......... .......... .......... .......... 70% 1.62M 1s\n  7800K .......... .......... .......... .......... .......... 71% 5.47M 1s\n  7850K .......... .......... .......... .......... .......... 71% 7.93M 1s\n  7900K .......... .......... .......... .......... .......... 72% 1.08M 1s\n  7950K .......... .......... .......... .......... .......... 72% 1.69M 1s\n  8000K .......... .......... .......... .......... .......... 72% 6.39M 1s\n  8050K .......... .......... .......... .......... .......... 73% 7.45M 1s\n  8100K .......... .......... .......... .......... .......... 73% 5.44M 1s\n  8150K .......... .......... .......... .......... .......... 74% 1.57M 1s\n  8200K .......... .......... .......... .......... .......... 74% 25.8M 1s\n  8250K .......... .......... .......... .......... .......... 75% 36.5M 1s\n  8300K .......... .......... .......... .......... .......... 75% 16.2M 1s\n  8350K .......... .......... .......... .......... .......... 76% 5.44M 1s\n  8400K .......... .......... .......... .......... .......... 76% 1006K 1s\n  8450K .......... .......... .......... .......... .......... 77% 32.4M 1s\n  8500K .......... .......... .......... .......... .......... 77% 36.0M 1s\n  8550K .......... .......... .......... .......... .......... 77% 2.37M 1s\n  8600K .......... .......... .......... .......... .......... 78% 28.7M 1s\n  8650K .......... .......... .......... .......... .......... 78% 3.12M 1s\n  8700K .......... .......... .......... .......... .......... 79% 28.7M 1s\n  8750K .......... .......... .......... .......... .......... 79% 6.93M 1s\n  8800K .......... .......... .......... .......... .......... 80% 22.1M 1s\n  8850K .......... .......... .......... .......... .......... 80% 16.6M 1s\n  8900K .......... .......... .......... .......... .......... 81% 39.7M 1s\n  8950K .......... .......... .......... .......... .......... 81% 2.21M 1s\n  9000K .......... .......... .......... .......... .......... 82% 2.11M 1s\n  9050K .......... .......... .......... .......... .......... 82% 2.48M 1s\n  9100K .......... .......... .......... .......... .......... 82% 31.0M 1s\n  9150K .......... .......... .......... .......... .......... 83% 28.3M 1s\n  9200K .......... .......... .......... .......... .......... 83% 31.0M 1s\n  9250K .......... .......... .......... .......... .......... 84% 2.69M 0s\n  9300K .......... .......... .......... .......... .......... 84% 6.40M 0s\n  9350K .......... .......... .......... .......... .......... 85% 31.9M 0s\n  9400K .......... .......... .......... .......... .......... 85% 3.83M 0s\n  9450K .......... .......... .......... .......... .......... 86% 5.03M 0s\n  9500K .......... .......... .......... .......... .......... 86% 26.1M 0s\n  9550K .......... .......... .......... .......... .......... 87% 30.8M 0s\n  9600K .......... .......... .......... .......... .......... 87% 1.52M 0s\n  9650K .......... .......... .......... .......... .......... 87% 30.0M 0s\n  9700K .......... .......... .......... .......... .......... 88% 37.3M 0s\n  9750K .......... .......... .......... .......... .......... 88% 1.30M 0s\n  9800K .......... .......... .......... .......... .......... 89% 9.93M 0s\n  9850K .......... .......... .......... .......... .......... 89% 1.85M 0s\n  9900K .......... .......... .......... .......... .......... 90% 28.6M 0s\n  9950K .......... .......... .......... .......... .......... 90% 10.0M 0s\n 10000K .......... .......... .......... .......... .......... 91% 1.60M 0s\n 10050K .......... .......... .......... .......... .......... 91% 5.11M 0s\n 10100K .......... .......... .......... .......... .......... 92% 3.52M 0s\n 10150K .......... .......... .......... .......... .......... 92% 3.29M 0s\n 10200K .......... .......... .......... .......... .......... 92% 3.71M 0s\n 10250K .......... .......... .......... .......... .......... 93% 33.4M 0s\n 10300K .......... .......... .......... .......... .......... 93% 36.8M 0s\n 10350K .......... .......... .......... .......... .......... 94% 2.82M 0s\n 10400K .......... .......... .......... .......... .......... 94% 2.79M 0s\n 10450K .......... .......... .......... .......... .......... 95% 35.4M 0s\n 10500K .......... .......... .......... .......... .......... 95% 4.47M 0s\n 10550K .......... .......... .......... .......... .......... 96% 36.2M 0s\n 10600K .......... .......... .......... .......... .......... 96% 55.1M 0s\n 10650K .......... .......... .......... .......... .......... 97% 67.1M 0s\n 10700K .......... .......... .......... .......... .......... 97% 2.94M 0s\n 10750K .......... .......... .......... .......... .......... 97% 24.8M 0s\n 10800K .......... .......... .......... .......... .......... 98% 4.28M 0s\n 10850K .......... .......... .......... .......... .......... 98% 23.3M 0s\n 10900K .......... .......... .......... .......... .......... 99% 4.72M 0s\n 10950K .......... .......... .......... .......... .......... 99% 1.98M 0s\n 11000K .......... .......... ........                        100% 32.9M\u003d3.0s\n\n2020-06-30 18:06:04 (3.56 MB/s) - ‘spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar’ saved [11292862/11292862]\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593540999500_1649374394",
      "id": "20190429-115420_1698791579",
      "dateCreated": "2020-06-30 18:16:39.501",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.dep\nz.reset()\nz.load(\"/zeppelin/dep/spark-streaming-kafka-0-8-assembly_2.11-2.0.2.jar\")",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:16:39.502",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res0: org.apache.zeppelin.dep.Dependency \u003d org.apache.zeppelin.dep.Dependency@6321b217\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593540999501_-106643066",
      "id": "20200630-074700_496348867",
      "dateCreated": "2020-06-30 18:16:39.501",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "",
      "text": "%producer.pyspark\n\ndf \u003d (spark.read.format(\"com.databricks.spark.csv\")\n        .option(\"header\", \"true\")\n        .option(\"inferSchema\",\"true\")\n        .load(\"/datadrive/census_1000.csv\"))\n        \ndf_list \u003d df.collect()\ndf.show()",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:16:39.502",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "editorHide": false,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---+---+-----------------+-------------+-------------+--------------------+------------------+--------------+-------------------+-------+------------+------------+--------------+------+\n|_c0|age|        workclass|    education|education-num|      marital-status|        occupation|  relationship|          ethnicity| gender|capital-gain|capital-loss|hours-per-week|  loan|\n+---+---+-----------------+-------------+-------------+--------------------+------------------+--------------+-------------------+-------+------------+------------+--------------+------+\n|  0| 39|        State-gov|    Bachelors|           13|       Never-married|      Adm-clerical| Not-in-family|              White|   Male|        2174|           0|            40| \u003c\u003d50K|\n|  1| 50| Self-emp-not-inc|    Bachelors|           13|  Married-civ-spouse|   Exec-managerial|       Husband|              White|   Male|           0|           0|            13| \u003c\u003d50K|\n|  2| 38|          Private|      HS-grad|            9|            Divorced| Handlers-cleaners| Not-in-family|              White|   Male|           0|           0|            40| \u003c\u003d50K|\n|  3| 53|          Private|         11th|            7|  Married-civ-spouse| Handlers-cleaners|       Husband|              Black|   Male|           0|           0|            40| \u003c\u003d50K|\n|  4| 28|          Private|    Bachelors|           13|  Married-civ-spouse|    Prof-specialty|          Wife|              Black| Female|           0|           0|            40| \u003c\u003d50K|\n|  5| 37|          Private|      Masters|           14|  Married-civ-spouse|   Exec-managerial|          Wife|              White| Female|           0|           0|            40| \u003c\u003d50K|\n|  6| 49|          Private|          9th|            5| Married-spouse-a...|     Other-service| Not-in-family|              Black| Female|           0|           0|            16| \u003c\u003d50K|\n|  7| 52| Self-emp-not-inc|      HS-grad|            9|  Married-civ-spouse|   Exec-managerial|       Husband|              White|   Male|           0|           0|            45|  \u003e50K|\n|  8| 31|          Private|      Masters|           14|       Never-married|    Prof-specialty| Not-in-family|              White| Female|       14084|           0|            50|  \u003e50K|\n|  9| 42|          Private|    Bachelors|           13|  Married-civ-spouse|   Exec-managerial|       Husband|              White|   Male|        5178|           0|            40|  \u003e50K|\n| 10| 37|          Private| Some-college|           10|  Married-civ-spouse|   Exec-managerial|       Husband|              Black|   Male|           0|           0|            80|  \u003e50K|\n| 11| 30|        State-gov|    Bachelors|           13|  Married-civ-spouse|    Prof-specialty|       Husband| Asian-Pac-Islander|   Male|           0|           0|            40|  \u003e50K|\n| 12| 23|          Private|    Bachelors|           13|       Never-married|      Adm-clerical|     Own-child|              White| Female|           0|           0|            30| \u003c\u003d50K|\n| 13| 32|          Private|   Assoc-acdm|           12|       Never-married|             Sales| Not-in-family|              Black|   Male|           0|           0|            50| \u003c\u003d50K|\n| 14| 40|          Private|    Assoc-voc|           11|  Married-civ-spouse|      Craft-repair|       Husband| Asian-Pac-Islander|   Male|           0|           0|            40|  \u003e50K|\n| 15| 34|          Private|      7th-8th|            4|  Married-civ-spouse|  Transport-moving|       Husband| Amer-Indian-Eskimo|   Male|           0|           0|            45| \u003c\u003d50K|\n| 16| 25| Self-emp-not-inc|      HS-grad|            9|       Never-married|   Farming-fishing|     Own-child|              White|   Male|           0|           0|            35| \u003c\u003d50K|\n| 17| 32|          Private|      HS-grad|            9|       Never-married| Machine-op-inspct|     Unmarried|              White|   Male|           0|           0|            40| \u003c\u003d50K|\n| 18| 38|          Private|         11th|            7|  Married-civ-spouse|             Sales|       Husband|              White|   Male|           0|           0|            50| \u003c\u003d50K|\n| 19| 43| Self-emp-not-inc|      Masters|           14|            Divorced|   Exec-managerial|     Unmarried|              White| Female|           0|           0|            45|  \u003e50K|\n+---+---+-----------------+-------------+-------------+--------------------+------------------+--------------+-------------------+-------+------------+------------+--------------+------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1593540999502_-597688966",
      "id": "20190424-153802_2004623441",
      "dateCreated": "2020-06-30 18:16:39.502",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%producer.pyspark\nimport time\nimport json\nimport random\nimport logging\n\nfrom kafka import KafkaProducer\nfrom kafka.errors import KafkaError\n\nKAFKA_BROKER \u003d \"172.25.0.12:9092\"\nKAFKA_TOPIC \u003d \"default_topic\"\n\nproducer \u003d KafkaProducer(bootstrap_servers\u003d[KAFKA_BROKER])\nindex \u003d 0\n\nwhile True:\n    \n    row_dict \u003d df_list[index].asDict()\n    \n    future \u003d producer.send(\n        topic\u003dKAFKA_TOPIC, \n        key\u003dstr(row_dict[\"_c0\"]).encode(\"utf-8\"),\n        value\u003djson.dumps(row_dict).encode(\"utf-8\"))\n    \n    try:\n        record_metadata \u003d future.get(timeout\u003d10)\n    except KafkaError:\n        # Decide what to do if produce request failed...\n        logging.exception(\"Error\")\n        pass\n    \n    producer.flush()\n    \n    index +\u003d 1\n    time.sleep(random.uniform(0.1,3.0))",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:16:39.502",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1593540999502_-2141916807",
      "id": "20190424-165258_808657351",
      "dateCreated": "2020-06-30 18:16:39.502",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.pyspark\n\nimport sys\nimport json\nfrom pyspark.streaming.kafka import KafkaUtils\nfrom pyspark.streaming import StreamingContext\n\n\n\nos.environ[\u0027PYSPARK_SUBMIT_ARGS\u0027] \u003d \u0027--jars spark-streaming-kafka-assembly_2.10-1.6.0.jar pyspark-shell\u0027\n\ntry:\n    # Reset streaming context if exists\n    ssc.stop(stopSparkContext\u003dFalse, stopGraceFully\u003dFalse)\nexcept:\n    pass\n\nssc \u003d StreamingContext(sc, batchDuration\u003d2)\n\nREDDIT_TOPIC \u003d \"default_topic\"\nKAFKA_BROKERS \u003d \"172.25.0.12:9092,172.25.0.13:9092\"\n\n#KAFKA_BROKER \u003d \"172.25.0.12:9092\"\n\nstream \u003d KafkaUtils.createDirectStream(\n                            ssc, \n                            [REDDIT_TOPIC], \n                            {\"metadata.broker.list\": KAFKA_BROKERS})\n\n#stream \u003d KafkaUtils.createDirectStream(\n#                            ssc, \n#                            [REDDIT_TOPIC], \n#                            {\"metadata.broker.list\": KAFKA_BROKER})\n\n\nstream \u003d stream.map(lambda x: json.loads(x[1]))\nstream \u003d stream.map(lambda x: (x[\"_c0\"], x[\"loan\"]))\n\nstream.pprint()\n\nssc.start()\nssc.awaitTermination()",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:16:39.502",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1593540999502_-562666901",
      "id": "20190423-122009_873241770",
      "dateCreated": "2020-06-30 18:16:39.502",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%consumer.pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2020-06-30 18:16:39.503",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1593540999503_-1823196939",
      "id": "20190429-143043_1027088896",
      "dateCreated": "2020-06-30 18:16:39.503",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "workingExample",
  "id": "2FE5M35JR",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "producer:shared_process": [],
    "sh:shared_process": [],
    "consumer:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}